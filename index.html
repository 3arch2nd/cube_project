<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">

    <title>ì…ì²´ë„í˜• ì™„ì „ ì •ë³µ</title>
    <meta property="og:title" content="ì…ì²´ë„í˜• ì™„ì „ ì •ë³µ">
    <meta property="og:description" content="ì „ê°œë„ ì™„ì„±í•˜ê¸° / ê²¹ì³ì§€ëŠ” ë¶€ë¶„ ì°¾ê¸° ë¬¸ì œ ìë™ ìƒì„±">
    <meta property="og:url" content="https://cube.3arch2nd.site">
    <meta property="og:type" content="website">

    <link href="https://fonts.googleapis.com/css2?family=Gowun+Dodum&display=swap" rel="stylesheet">

    <script src="https://cdn.rawgit.com/davidshimjs/qrcodejs/gh-pages/qrcode.min.js"></script>

    <style>
        body {
            margin: 0;
            font-family: 'Gowun Dodum', sans-serif;
            background-color: #f4f7f6;
            color: #333;
            text-align: center;
        }

        h1 {
            margin-top: 30px;
            color: #4b8134;
        }

        .container {
            width: 90%;
            max-width: 900px;
            margin: 20px auto;
            background: #fff;
            border-radius: 12px;
            padding: 25px;
            box-shadow: 0 6px 20px rgba(0,0,0,0.1);
        }

        .hidden { display:none !important; }

        button {
            padding: 12px 20px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            cursor: pointer;
            margin: 5px;
            font-family: inherit;
        }

        .green-btn { background:#92c572; color:white; }
        .gray-btn { background:#e5e5e5; }
        .orange-btn { background:#ffc457; }
        .red-btn { background:#dd6666; color:white; }
        button.selected { background:#ffc107 !important; color:#333 !important; font-weight:bold; }

        .section {
            margin-top:20px;
            padding:20px;
            border-radius:12px;
            background:#fafafa;
            border:1px solid #ddd;
            text-align:center;
        }

        .option-row {
            display:flex;
            justify-content:center;
            flex-wrap:wrap;
            gap:10px;
            margin-top:10px;
        }

        /* ë¬¸ì œ í˜ì´ì§€ */
        .canvas-wrapper {
            background: #f0f0f0; 
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 10px;
            margin: 20px auto;
            display: inline-block; 
        }
        
        #net-canvas {
            width:350px;
            height:350px;
            background:white;
            border:2px solid #333;
            margin: 0 auto;
        }
        
        #three-view {
            width:350px;
            height:350px;
            background:#000;
            margin:20px auto 0;
            transform: translateZ(0); 
            will-change: transform;
        }

        /* ìŠ¬ë¼ì´ë” */
        #fold-control {
            margin: 10px auto 20px;
            padding: 10px 15px;
            background: #f9f9f9;
            border: 1px solid #ddd;
            border-radius: 8px;
            width: 320px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }
        #fold-slider { flex-grow: 1; }

        /* QR íŒì—… */
        #qr-popup {
            position:fixed;
            left:0; top:0;
            width:100%;
            height:100%;
            display:none;
            align-items:center;
            justify-content:center;
            background:rgba(0,0,0,0.5);
            z-index:1000;
        }
        #qr-box {
            background:white;
            padding:30px;
            border-radius:12px;
            text-align:center;
        }
    </style>
</head>

<body>

<h1>ì…ì²´ë„í˜• ì™„ì „ ì •ë³µ (ì •ìœ¡ë©´ì²´)</h1>

<button id="qr-btn" class="gray-btn" style="position:fixed; top:20px; right:20px;">
    QR ì½”ë“œ
</button>

<div class="container">

    <!-- â­ 1. ëª¨ë“œ ì„ íƒ í˜ì´ì§€ -->
    <div id="mode-select-page">
        <h2>í•™ìŠµ ëª¨ë“œë¥¼ ì„ íƒí•˜ì„¸ìš”.</h2>
        <div class="option-row">
            <button class="green-btn" id="btn-mode-net">ğŸ§© ì „ê°œë„ ì™„ì„±í•˜ê¸°</button>
            <button class="orange-btn" id="btn-mode-overlap">ğŸ¯ ê²¹ì³ì§€ëŠ” ë¶€ë¶„ ì°¾ê¸°</button>
        </div>
    </div>

    <!-- â­ 2. ì „ê°œë„ ì™„ì„±í•˜ê¸° ì„¤ì • -->
    <div id="setup-net" class="hidden">

        <h2>ì „ê°œë„ ì™„ì„±í•˜ê¸° (ì •ìœ¡ë©´ì²´) - ì„¤ì •</h2>

        <div class="section">
            <h3>ì§„í–‰ ë°©ì‹</h3>
            <div class="option-row" id="net-run-group">
                <button data-run="practice" class="gray-btn">ì—°ìŠµ</button>
                <button data-run="real" class="gray-btn">ì‹¤ì „</button>
            </div>
        </div>

        <div class="section">
            <h3>ë¬¸ì œ ê°œìˆ˜</h3>
            <div class="option-row">
                <button class="gray-btn" id="net-q-minus">-</button>
                <span id="net-q-display" style="font-size:22px;">10</span>
                <button class="gray-btn" id="net-q-plus">+</button>
            </div>
        </div>

        <button id="start-net" class="green-btn">ë¬¸ì œ ì‹œì‘í•˜ê¸°</button>
    </div>

    <!-- â­ 3. ê²¹ì¹¨ ì°¾ê¸° ì„¤ì • -->
    <div id="setup-overlap" class="hidden">

        <h2>ê²¹ì³ì§€ëŠ” ë¶€ë¶„ ì°¾ê¸° (ì •ìœ¡ë©´ì²´) - ì„¤ì •</h2>

        <div class="section">
            <h3>ê²¹ì¹¨ ìœ í˜•</h3>
            <div class="option-row" id="ov-type-group">
                <button data-type="point" class="gray-btn">ì </button>
                <button data-type="edge" class="gray-btn">ì„ ë¶„</button>
                <button data-type="both" class="gray-btn">ë‘˜ ë‹¤</button>
            </div>
        </div>

        <div class="section">
            <h3>ì§„í–‰ ë°©ì‹</h3>
            <div class="option-row" id="ov-run-group">
                <button data-run="practice" class="gray-btn">ì—°ìŠµ</button>
                <button data-run="real" class="gray-btn">ì‹¤ì „</button>
            </div>
        </div>

        <div class="section">
            <h3>ë¬¸ì œ ê°œìˆ˜</h3>
            <div class="option-row">
                <button class="gray-btn" id="ov-q-minus">-</button>
                <span id="ov-q-display" style="font-size:22px;">10</span>
                <button class="gray-btn" id="ov-q-plus">+</button>
            </div>
        </div>

        <button id="start-overlap" class="orange-btn">ë¬¸ì œ ì‹œì‘í•˜ê¸°</button>
    </div>

    <!-- â­ 4. ë¬¸ì œ í˜ì´ì§€ -->
    <div id="problem-page" class="hidden">
        <h2 id="problem-title">ë¬¸ì œ</h2>

        <div class="canvas-wrapper">
            <canvas id="net-canvas" width="350" height="350"></canvas>
        </div>

        <canvas id="three-view" width="350" height="350"></canvas>

        <div id="fold-control">
            <span>í¼ì¹¨(0)</span>
            <input type="range" id="fold-slider" min="0" max="1" step="0.01" value="0">
            <span>(1)ì ‘í˜</span>
            <span id="slider-value">0.00</span>
        </div>

        <div class="option-row">
            <button id="btn-check" class="green-btn">ì •ë‹µ í™•ì¸</button>
            <button id="btn-next" class="orange-btn hidden">ë‹¤ìŒ ë¬¸ì œ</button>
            <button id="btn-exit" class="red-btn">ì¢…ë£Œ</button>
        </div>
    </div>

    <!-- â­ 5. ê²°ê³¼ í˜ì´ì§€ -->
    <div id="result-page" class="hidden">
        <h2>í•™ìŠµ ê²°ê³¼</h2>
        <p>ì •ë‹µë¥ : <span id="result-acc"></span></p>
        <button id="btn-restart" class="green-btn">ì²˜ìŒìœ¼ë¡œ ëŒì•„ê°€ê¸°</button>
    </div>

</div>

<!-- QR íŒì—… -->
<div id="qr-popup">
    <div id="qr-box">
        <h3>QR ì½”ë“œ</h3>
        <div id="qr-holder"></div>
        <button id="qr-close" class="gray-btn">ë‹«ê¸°</button>
    </div>
</div>

<!-- Babylon.js -->
<script src="https://cdn.babylonjs.com/babylon.max.js"></script>
<script src="https://cdn.babylonjs.com/loaders/babylonjs.loaders.js"></script>

<!-- ì•± ë¡œì§ -->
<script src="./js/cube_nets.js"></script>
<script src="./js/ui.js"></script>
<script src="./js/validator.js"></script>
<script src="./js/overlap.js"></script>
<script src="./js/foldEngine.js"></script>
<script src="./js/main.js"></script>

<!-- ìŠ¬ë¼ì´ë” ì—°ë™ (foldEngine.js ì˜ setFoldProgress ì‚¬ìš©) -->
<script>
document.getElementById("fold-slider").addEventListener("input", (e) => {
    const v = Number(e.target.value);
    FoldEngine.setFoldProgress(v);
    document.getElementById("slider-value").textContent = v.toFixed(2);
});
</script>

</body>
</html>
